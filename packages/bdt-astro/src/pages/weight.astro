---
import BaseLayout from '../layouts/BaseLayout.astro'
import Pagination from "@components/pagination/pagination.tsx";
import getWeighins from "@weight-fetcher/getWeighins.ts";
import getAllWeighins from "@weight-fetcher/getAllWeighins.ts";
import WeightChart from '@components/visualisations/weight-graph.tsx';

const {meta} = await getWeighins();
const weighins = await getAllWeighins();
let weekAgo = new Date();
weekAgo.setDate(new Date().getDate() - 7);
---

<BaseLayout title="Weighins">
  <div class="stack listing">
    <h1>Weighins</h1>
    <WeightChart client:load weighins={weighins} filter={{from: weekAgo.toISOString()}} />
    <div class="content">
      <p>This is how I'm currently doing weight-wise. This is a temporal space, while I load this data into a visualisation of some sort.</p>
    </div>
    
    <Pagination tag={`a`} pageNumber={1} urlRoot={`/weight/page`} pageInfo={{hasNextPage: meta.hasNextPage, hasPreviousPage: meta.hasPreviousPage}} />
  </div>
</BaseLayout>
    