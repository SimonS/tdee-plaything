---
import BaseLayout from '../layouts/BaseLayout.astro'
import MediaObject from "@components/compositions/media-object.tsx";
import Pagination from "@components/pagination/pagination.tsx";
import getFilms from "@film-fetcher/getFilms.ts";

const {films, meta} = await getFilms();
---

<BaseLayout title="Films I've seen recently">
  <div class="stack">
    <h1>Films</h1>
    <p>These are films I've watched recently, as logged in <a href="https://letterboxd.com/simonscarfe/">Letterboxd</a>.</p>
    {films.map(film => (
      <MediaObject imgObj={{
        src: film.meta.image,
        alt:`Poster for '${film.filmTitle}'`
      }}>
        <header>
          <h2>{film.filmTitle} ({film.year})</h2>
        </header>
        <dl>
          <dt>Viewed</dt>
          <dd>
            <time className="dt-published" dateTime={film.watchedDate}>
              {new Date(film.watchedDate).toDateString()}
            </time>
          </dd>
          <dt>Rated</dt>
          <dd>{film.rating}/5</dd>
        </dl>
        {film.content && (
          <a href={film.reviewLink}>I wrote some thoughts on Letterboxd</a>
        )}
      </MediaObject>
    ))}
    <Pagination pageNumber={1} urlRoot={`/films/page`} pageInfo={{hasNextPage: meta.hasNextPage, hasPreviousPage: meta.hasPreviousPage}} />
  </div>
</BaseLayout>
    